import datetime\n\nfrom gatox.models.organization import Organization\nfrom gatox.models.repository import Repository\n\nclass Execution:\n    """Wrapper class to provide accessor methods against a full Gato execution run."""\n\n    def __init__(self):\n        """Initialize wrapper class."""\n        self.user_details = None\n        self.organizations = []\n        self.repositories = []\n        self.timestamp = datetime.datetime.now()\n\n    def add_organizations(self, organizations):\n        """Add list of organization wrapper objects.\n\n        Args:\n            organizations (list[Organization]): List of org wrappers.\n        """\n        if organizations:\n            self.organizations = organizations\n\n    def add_repositories(self, repositories):\n        """Add list of repository wrapper objects.\n\n        Args:\n            repositories (list[Repository]): List of repo wrappers.\n        """\n        if repositories:\n            self.repositories = repositories\n\n    def set_user_details(self, user_details):\n        """Set user details.\n\n        Args:\n            user_details (dict): Details about the user's permissions.\n        """\n        self.user_details = user_details\n\n    def toJSON(self):\n        """Converts the run to Gato JSON representation.\n\n        Returns:\n            dict: JSON representation of the execution run.\n        """\n        if self.user_details:\n            representation = {\n                "username": self.user_details["user"],\n                "scopes": self.user_details["scopes"],\n                "enumeration": {\n                    "timestamp": self.timestamp.ctime(),\n                    "organizations": [\n                        organization.toJSON() for organization in self.organizations\n                    ],\n                    "repositories": [\n                        repository.toJSON() for repository in self.repositories\n                    ],\n                },\n            }\n            return representation\n        return {}\n