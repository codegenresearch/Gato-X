import datetime\n\nfrom gatox.models.organization import Organization\nfrom gatox.models.repository import Repository\n\nclass Execution:\n    """Wrapper class to provide accessor methods against a full Gato execution run.\n\n    This class is designed to encapsulate the details of a Gato execution run,\n    including user details, organizations, and repositories. It provides methods to\n    add organizations and repositories, set user details, and convert the execution\n    details to a JSON representation.\n    """\n\n    def __init__(self):\n        """Initialize wrapper class.\n\n        Initializes the Execution object with empty lists for organizations and\n        repositories, and the current timestamp.\n        """\n        self.user_details = None\n        self.organizations: list[Organization] = []\n        self.repositories: list[Repository] = []\n        self.timestamp = datetime.datetime.now()\n\n    def add_organizations(self, organizations: list[Organization]):\n        """Add list of organization wrapper objects.\n\n        Args:\n            organizations (list[Organization]): List of org wrappers.\n        """\n        if organizations:\n            self.organizations = organizations\n\n    def add_repositories(self, repositories: list[Repository]):\n        """Add list of repository wrapper objects.\n\n        Args:\n            repositories (list[Repository]): List of repo wrappers.\n        """\n        if repositories:\n            self.repositories = repositories\n\n    def set_user_details(self, user_details: dict):\n        """Set user details.\n\n        Args:\n            user_details (dict): Details about the user's permissions.\n        """\n        self.user_details = user_details\n\n    def toJSON(self) -> dict:\n        """Converts the run to Gato JSON representation.\n\n        Returns:\n            dict: JSON representation of the execution run.\n        """\n        if self.user_details:\n            representation = {\n                "username": self.user_details["user"],\n                "scopes": self.user_details["scopes"],\n                "enumeration": {\n                    "timestamp": self.timestamp.ctime(),\n                    "organizations": [\n                        organization.toJSON() for organization in self.organizations\n                    ],\n                    "repositories": [\n                        repository.toJSON() for repository in self.repositories\n                    ],\n                },\n            }\n            return representation\n        return {}\n